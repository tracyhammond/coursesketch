<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: common/lecture/lecturePage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: common/lecture/lecturePage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>validateFirstRun(document.currentScript);

(function() {
    CourseSketch.lecturePage = [];
    CourseSketch.lecturePage.waitScreenManager = new WaitScreenManager();
    CourseSketch.lecturePage.selectedSlideIndex = undefined;

    CourseSketch.lecturePage.doResize = function(event) {
        var target = event.target;

        // Add the change in coords to the previous width of the target element
        var newWidth  = parseFloat($(target).width()) + event.dx;
        var newHeight = parseFloat($(target).height()) + event.dy;

        // Update the element's style
        target.style.width  = newWidth + 'px';
        target.style.height = newHeight + 'px';

        target.textContent = newWidth + 'Ã—' + newHeight;
    };

    CourseSketch.lecturePage.loadTextBox = function(textBox) {
        var elem = CourseSketch.lecturePage.newTextBox();
        elem.loadData(textBox);
    };

    CourseSketch.lecturePage.loadMultiChoiceQuestion = function(question) {
        var elem = CourseSketch.lecturePage.newMultiChoiceQuestion();
        elem.loadData(question);
    };

    CourseSketch.lecturePage.loadImageBox = function(imageBox) {
        var elem = CourseSketch.lecturePage.newImage();
        elem.loadData(imageBox);
    };

    CourseSketch.lecturePage.loadEmbeddedHtml = function(embeddedHtml) {
        var elem = CourseSketch.lecturePage.newEmbeddedHtml();
        elem.loadData(embeddedHtml);
    };

    /**
     * Adds a new text box to the currently selected lecture slide.
     */
    CourseSketch.lecturePage.newTextBox = function() {
        var textBox = undefined;
        if (CourseSketch.connection.isInstructor) {
            textBox = document.createElement('text-box-creation');
        } else {
            textBox = document.createElement('text-box-viewing');
        }
        document.querySelector('#slide-content').appendChild(textBox);
        textBox.setFinishedListener(CourseSketch.lecturePage.saveTextBox);
        return textBox;
    };

    /**
     * Adds a new sketch content element to the currently selected slide
     */
    CourseSketch.lecturePage.newSketchContent = function() {
        var sketchSurface = document.createElement('sketch-surface');
        document.querySelector('#slide-content').appendChild(sketchSurface);
        setTimeout(function() {
            sketchSurface.resizeSurface();
        }, 500);
        return sketchSurface;
    };

    /**
     * Adds a new image to the currently selected slide
     * @param {element} input the input element from the form specifying the image
     */
    CourseSketch.lecturePage.newImage = function(input) {
        var imagebox = document.createElement('image-box');
        document.querySelector('#slide-content').appendChild(imagebox);

        // TODO: Save resize info in DB; better to leave this disabled until that works
        // imagebox.className = 'resize';

        if (!isUndefined(input) &amp;&amp; input !== null &amp;&amp; input.files &amp;&amp; input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
                imagebox.setSrc(e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
        }
        imagebox.setFinishedListener(CourseSketch.lecturePage.saveImageBox);
        return imagebox;
    };

    /**
     * Adds a new embedded HTML element to the currently selected slide.
     * @param {element} form the form that contains the HTML element to be added
     */
    CourseSketch.lecturePage.newEmbeddedHtml = function(form) {
        var embeddedHtml = document.createElement('embedded-html');
        document.querySelector('#slide-content').appendChild(embeddedHtml);
        if (!isUndefined(form) &amp;&amp; form !== null) {
            embeddedHtml.setHtml(form.html.value);
        }
        embeddedHtml.setFinishedListener(CourseSketch.lecturePage.saveEmbeddedHtml);
        return embeddedHtml;
    };

    /**
     * Adds a new multiple choice question to the currently selected slide.
     */
    CourseSketch.lecturePage.newMultiChoiceQuestion = function() {
        var question = document.createElement('question-element');
        var multiChoice = document.createElement('multi-choice');
        document.getElementById('slide-content').appendChild(question);
        question.addAnswerContent(multiChoice);
        question.setFinishedListener(CourseSketch.lecturePage.saveQuestion);
        return question;
    };

    /**
     * Renders a slide to the DOM.

     * @param {protoObject} slide
     *            protobuf slide element to be rendered
     */
    CourseSketch.lecturePage.renderSlide = function(slide) {
        document.getElementById('slide-content').innerHTML = '';
        CourseSketch.lecturePage.currentSlide = slide;
        for (var i = 0; i &lt; slide.elements.length; ++i) {
            var element = slide.elements[i];
            if (!isUndefined(element.textBox) &amp;&amp; element.textBox !== null) {
                CourseSketch.lecturePage.loadTextBox(element.textBox);
            } else if (!isUndefined(element.question) &amp;&amp; element.question !== null) {
                if (!isUndefined(element.question.multipleChoice) &amp;&amp; element.question.multipleChoice !== null) {
                    CourseSketch.lecturePage.loadMultiChoiceQuestion(element.question);
                } else {
                    throw 'Sketch questions are not yet supported';
                }
            } else if (!isUndefined(element.image) &amp;&amp; element.image !== null) {
                CourseSketch.lecturePage.loadImageBox(element.image);
            } else if (!isUndefined(element.embeddedHtml) &amp;&amp; element.embeddedHtml !== null) {
                CourseSketch.lecturePage.loadEmbeddedHtml(element.embeddedHtml);
            } else {
                throw 'Tried to load invalid element';
            }
        }
    };

    /**
     * Adds a wait overlay, preventing the user from interacting with the page until it is removed.
     */
    CourseSketch.lecturePage.addWaitOverlay = function() {
        CourseSketch.lecturePage.waitScreenManager.buildOverlay(document.querySelector('body'));
        CourseSketch.lecturePage.waitScreenManager.buildWaitIcon(document.getElementById('overlay'));
        document.getElementById('overlay').querySelector('.waitingIcon').classList.add('centered');
    };

    /**
     * Removes the wait overlay from the DOM if it exists.
     */
    CourseSketch.lecturePage.removeWaitOverlay = function() {
        if (!isUndefined(document.getElementById('overlay')) &amp;&amp; document.getElementById('overlay') !== null) {
            document.querySelector('body').removeChild(document.getElementById('overlay'));
        }
    };

    /**
     * Adds a slide thumbnail to the DOM.
     *
     * @param {int} slideIndex
     *            index of the slide in the current lecture's protobuf
     *            object.
     */
    CourseSketch.lecturePage.addSlideToDom = function(slideIndex) {
        var slideThumb = document.createElement('span');
        slideThumb.id = slideIndex;
        slideThumb.className = 'slide-thumb';
        slideThumb.textContent = slideIndex + 1;
        slideThumb.onclick = function() {
            CourseSketch.lecturePage.selectSlide(slideIndex);
        };
        document.querySelector('#slides>.content').appendChild(slideThumb);
    };

    /**
     * Displays all of the slides for the current lecture.
     */
    CourseSketch.lecturePage.displaySlides = function() {
        $('#lecture-title').text(CourseSketch.lecturePage.lecture.name);
        $('.slide-thumb:not("#add")').each(function() {
            $(this).remove();
        });
        for (var i = 0; i &lt; CourseSketch.lecturePage.lecture.idList.length; ++i) {
            CourseSketch.lecturePage.addSlideToDom(i);
        }
        if (CourseSketch.lecturePage.lecture.idList.length > 0) {
            if (!isUndefined(CourseSketch.lecturePage.selectedSlideIndex)) {
                CourseSketch.lecturePage.selectSlide(CourseSketch.lecturePage.selectedSlideIndex);
            } else {
                CourseSketch.lecturePage.selectSlide(0);
            }
        } else {
            CourseSketch.lecturePage.newSlide();
        }
    };
})();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BaseException.html">BaseException</a></li><li><a href="CommandException.html">CommandException</a></li><li><a href="DatabaseException.html">DatabaseException</a></li><li><a href="Graphics.html">Graphics</a></li><li><a href="LoginSystem.html">LoginSystem</a></li><li><a href="NavigationPanel.html">NavigationPanel</a></li><li><a href="ProblemNavigator.html">ProblemNavigator</a></li><li><a href="ProtobufSetup.html">ProtobufSetup</a></li><li><a href="ProtoDatabase.html">ProtoDatabase</a></li><li><a href="Redirector.html">Redirector</a></li><li><a href="RegisterSystem.html">RegisterSystem</a></li><li><a href="SchoolDataManager.html">SchoolDataManager</a></li><li><a href="SchoolItem.html">SchoolItem</a></li><li><a href="SketchSurface.html">SketchSurface</a></li><li><a href="UndoRedoException.html">UndoRedoException</a></li><li><a href="UpdateException.html">UpdateException</a></li><li><a href="UpdateManager.html">UpdateManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addAnswer">addAnswer</a></li><li><a href="global.html#addAnswerContent">addAnswerContent</a></li><li><a href="global.html#addCallback">addCallback</a></li><li><a href="global.html#addClickFunction">addClickFunction</a></li><li><a href="global.html#addEventMapping">addEventMapping</a></li><li><a href="global.html#addSynchronousUpdate">addSynchronousUpdate</a></li><li><a href="global.html#addToolArea">addToolArea</a></li><li><a href="global.html#addUpdate">addUpdate</a></li><li><a href="global.html#AdvanceDataListener">AdvanceDataListener</a></li><li><a href="global.html#ArrayException">ArrayException</a></li><li><a href="global.html#assignValues">assignValues</a></li><li><a href="global.html#build">build</a></li><li><a href="global.html#buildExpandEvent">buildExpandEvent</a></li><li><a href="global.html#buildOverlay">buildOverlay</a></li><li><a href="global.html#buildPercent">buildPercent</a></li><li><a href="global.html#buildWaitIcon">buildWaitIcon</a></li><li><a href="global.html#CallbackBarrier">CallbackBarrier</a></li><li><a href="global.html#checkOverflow">checkOverflow</a></li><li><a href="global.html#clearCallbacks">clearCallbacks</a></li><li><a href="global.html#clearUpdates">clearUpdates</a></li><li><a href="global.html#close">close</a></li><li><a href="global.html#Connection">Connection</a></li><li><a href="global.html#continueButton">continueButton</a></li><li><a href="global.html#correctSize">correctSize</a></li><li><a href="global.html#CourseSketch">CourseSketch</a></li><li><a href="global.html#createBarrier">createBarrier</a></li><li><a href="global.html#createButton">createButton</a></li><li><a href="global.html#createFancySchoolItem">createFancySchoolItem</a></li><li><a href="global.html#createMarker">createMarker</a></li><li><a href="global.html#createNewPath">createNewPath</a></li><li><a href="global.html#createSchoolList">createSchoolList</a></li><li><a href="global.html#createSketch">createSketch</a></li><li><a href="global.html#createTable">createTable</a></li><li><a href="global.html#deleteSketch">deleteSketch</a></li><li><a href="global.html#detachedCallback">detachedCallback</a></li><li><a href="global.html#EmbeddedHtml">EmbeddedHtml</a></li><li><a href="global.html#emptyQueue">emptyQueue</a></li><li><a href="global.html#endPath">endPath</a></li><li><a href="global.html#executeEvent">executeEvent</a></li><li><a href="global.html#fillCanvas">fillCanvas</a></li><li><a href="global.html#finalize">finalize</a></li><li><a href="global.html#getCleanUpdateList">getCleanUpdateList</a></li><li><a href="global.html#getConnection">getConnection</a></li><li><a href="global.html#getCurrentAssignment">getCurrentAssignment</a></li><li><a href="global.html#getCurrentNumber">getCurrentNumber</a></li><li><a href="global.html#getCurrentProblemId">getCurrentProblemId</a></li><li><a href="global.html#getCurrentSketch">getCurrentSketch</a></li><li><a href="global.html#getCurrentTime">getCurrentTime</a></li><li><a href="global.html#getCurrentUpdate">getCurrentUpdate</a></li><li><a href="global.html#getFinishedCallback">getFinishedCallback</a></li><li><a href="global.html#getHostElement">getHostElement</a></li><li><a href="global.html#getLength">getLength</a></li><li><a href="global.html#getListLength">getListLength</a></li><li><a href="global.html#getPaper">getPaper</a></li><li><a href="global.html#getProblemText">getProblemText</a></li><li><a href="global.html#getProblemType">getProblemType</a></li><li><a href="global.html#getSketch">getSketch</a></li><li><a href="global.html#getSupportedEnums">getSupportedEnums</a></li><li><a href="global.html#getSupportedObjects">getSupportedObjects</a></li><li><a href="global.html#getUpdateList">getUpdateList</a></li><li><a href="global.html#GivenanSrlUpdateaRequestiscreated.">Given an SrlUpdate a Request is created.</a></li><li><a href="global.html#gotoNext">gotoNext</a></li><li><a href="global.html#goToNextSlide">goToNextSlide</a></li><li><a href="global.html#gotoPrevious">gotoPrevious</a></li><li><a href="global.html#goToProblem">goToProblem</a></li><li><a href="global.html#hasNext">hasNext</a></li><li><a href="global.html#hasPrevious">hasPrevious</a></li><li><a href="global.html#HighlightText">HighlightText</a></li><li><a href="global.html#ImageBox">ImageBox</a></li><li><a href="global.html#IndexManager">IndexManager</a></li><li><a href="global.html#Inheritssetsupinheritanceforfunctionsthis.Inherits(SuperClass);//supercallinsideobjectANDSubClass.Inherits(SuperClass);">Inherits
sets up inheritance for functions

this.Inherits(SuperClass); // super call inside object AND
SubClass.Inherits(SuperClass);</a></li><li><a href="global.html#initializeCanvas">initializeCanvas</a></li><li><a href="global.html#initializeElement">initializeElement</a></li><li><a href="global.html#InputListener">InputListener</a></li><li><a href="global.html#isConnected">isConnected</a></li><li><a href="global.html#isDataLoaded">isDataLoaded</a></li><li><a href="global.html#isDescriptionOverflow">isDescriptionOverflow</a></li><li><a href="global.html#isLastUpdateSave">isLastUpdateSave</a></li><li><a href="global.html#isLastUpdateSubmission">isLastUpdateSubmission</a></li><li><a href="global.html#isValidForSaving">isValidForSaving</a></li><li><a href="global.html#isValidForSubmission">isValidForSubmission</a></li><li><a href="global.html#loadData">loadData</a></li><li><a href="global.html#loadLectures">loadLectures</a></li><li><a href="global.html#loadSketch">loadSketch</a></li><li><a href="global.html#loadSlides">loadSlides</a></li><li><a href="global.html#MultiChoice">MultiChoice</a></li><li><a href="global.html#Playback">Playback</a></li><li><a href="global.html#ProblemToolBar">ProblemToolBar</a></li><li><a href="global.html#Question">Question</a></li><li><a href="global.html#reconnect">reconnect</a></li><li><a href="global.html#redoAction">redoAction</a></li><li><a href="global.html#refresh">refresh</a></li><li><a href="global.html#reloadAssignment">reloadAssignment</a></li><li><a href="global.html#reloadProblems">reloadProblems</a></li><li><a href="global.html#removeAnswer">removeAnswer</a></li><li><a href="global.html#removeCallback">removeCallback</a></li><li><a href="global.html#removeEventMapping">removeEventMapping</a></li><li><a href="global.html#removeItem">removeItem</a></li><li><a href="global.html#removeListener">removeListener</a></li><li><a href="global.html#resetValues">resetValues</a></li><li><a href="global.html">runCommand
Runs a specific command given its lastUpdateType.</a></li><li><a href="global.html#saveData">saveData</a></li><li><a href="global.html#SchoolItemBuilder">SchoolItemBuilder</a></li><li><a href="global.html#sendlocalScope">sendlocalScope</a></li><li><a href="global.html#sendRequest">sendRequest</a></li><li><a href="global.html#setAssignmentId">setAssignmentId</a></li><li><a href="global.html#setBoxState">setBoxState</a></li><li><a href="global.html#setCancelCallbackThecallbackiscalledwhentheregisterbuttonispressed.">setCancelCallback
The callback is called when the register button is pressed.</a></li><li><a href="global.html#setCorrectAnswer">setCorrectAnswer</a></li><li><a href="global.html#setCurrentSketch">setCurrentSketch</a></li><li><a href="global.html#setDrawUpdate">setDrawUpdate</a></li><li><a href="global.html#setEditCallback">setEditCallback</a></li><li><a href="global.html#setLastSaveTime">setLastSaveTime</a></li><li><a href="global.html#setListener">setListener</a></li><li><a href="global.html#setListeners">setListeners</a></li><li><a href="global.html#setOnSuccessLoginThecallbackiscalledwithoneparameter.">setOnSuccessLogin
The callback is called with one parameter.</a></li><li><a href="global.html#setParentSketch">setParentSketch</a></li><li><a href="global.html#setParentSketchId">setParentSketchId</a></li><li><a href="global.html#setPreferredIndex">setPreferredIndex</a></li><li><a href="global.html#setPreviewText">setPreviewText</a></li><li><a href="global.html#setRedoCallback">setRedoCallback</a></li><li><a href="global.html#setRegisterCallbackThecallbackiscalledwhentheregisterbuttonispressed.">setRegisterCallback
The callback is called when the register button is pressed.</a></li><li><a href="global.html#setRemoveFunction">setRemoveFunction</a></li><li><a href="global.html#setSaveCallback">setSaveCallback</a></li><li><a href="global.html#setSketch">setSketch</a></li><li><a href="global.html#setSketchClickedFunction">setSketchClickedFunction</a></li><li><a href="global.html#setSketchManager">setSketchManager</a></li><li><a href="global.html#setSubmissionInformation">setSubmissionInformation</a></li><li><a href="global.html#setSubmitCallback">setSubmitCallback</a></li><li><a href="global.html#setUiLoaded">setUiLoaded</a></li><li><a href="global.html#setUndoCallback">setUndoCallback</a></li><li><a href="global.html#setupAttributes">setupAttributes</a></li><li><a href="global.html#setupCallbacksSetupsupthecallbackfortheregisterbuttonandthelostpasswordbutton.">setupCallbacks
Setups up the callback for the register button and the lost password button.</a></li><li><a href="global.html#setUpdateList">setUpdateList</a></li><li><a href="global.html#setUpdateTime">setUpdateTime</a></li><li><a href="global.html#setUpEditButtons">setUpEditButtons</a></li><li><a href="global.html#setWrapperFunction">setWrapperFunction</a></li><li><a href="global.html#showFormattedDate">showFormattedDate</a></li><li><a href="global.html#SketchSurfaceManager">SketchSurfaceManager</a></li><li><a href="global.html#speakText">speakText</a></li><li><a href="global.html#SubmissionPanel">SubmissionPanel</a></li><li><a href="global.html#TextBox">TextBox</a></li><li><a href="global.html#TimelineMarker">TimelineMarker</a></li><li><a href="global.html#toggleSelection">toggleSelection</a></li><li><a href="global.html#undoAction">undoAction</a></li><li><a href="global.html#updatePath">updatePath</a></li><li><a href="global.html#writeTextData">writeTextData</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta2</a> on Fri Mar 13 2015 04:13:07 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
