<head>
<base href="../../">
	<script type="text/javascript" src="js/connection/libraries/Long.min.js"></script>
	<script type="text/javascript" src="js/connection/libraries/ByteBuffer.min.js"></script>
	<script type="text/javascript" src="js/connection/libraries/Protobuf.min.js"></script>
	<script type="text/javascript" src="js/utils/utilityFunctions.js"></script>
	<script type="text/javascript" src="js/utils/loadingManager.js"></script>

	<script type="text/javascript" src="js/connection/connection_library.js"></script>
	<script type="text/javascript" src="js/connection/advance_data_listener.js"></script>
	<script type="text/javascript" src="js/utils/database.js"></script>
	<script type="text/javascript" src="js/school/schoolDataManager.js"></script>
	<script type="text/javascript" src="js/persistant_data/class_data.js"></script>
	<script>
	var serverConnection;
	var database;
	function initializeServer() {
    	var wsUri = "goldberglinux02.tamu.edu:8888"; // our serve
    	serverConnection = new Connection(wsUri,false);
    	serverConnection.setOnCloseListener(function(evt) {
			var reconnect = false;
			if (evt.code == CONNECTION_LOST) {
				alert('can not connect to the server');
				reconnect = true;
			} else if(evt.code == SERVER_FULL) {
				alert(evt.reason); // Here we can try to connect to other servers.
			} else {
				alert("SERVER CLOSED CONNECTION");
				reconnect = true;
			}
			if (reconnect) {
				console.log("attempting to reconnet");
				intervalVariable = setInterval(function() {console.log("RECONNECTING!");createWebSocket();}, 3000); 
			}
		});
    }
	initializeServer();
	addLoadEvent( function() {
		console.log(QueryBuilder);
		database = new schoolDataManager("david", new AdvanceDataListener(serverConnection, Request, QueryBuilder),
				serverConnection, SchoolBuilder, QueryBuilder, Request, dcodeIO.ByteBuffer);
	});
	
	function saveCourse() {
		console.log("adding course");
		console.log(user_courses["Course_01"]);
		alert(user_courses["Course_01"]);
		database.setCourse(user_courses["Course_01"]);
	}
	
	function getCourse() {
		console.log("getting course Course_01");
		database.getCourse("Course_01", function(course) {
			console.log(course);
		});
	}

	function getFakeCourse() {
		console.log("getting course Course_NE");
		database.getCourse("Course_NE", function(course) {
			console.log(course);
		});
	}

	function clearData() {
		database.emptySchoolData();
	}
	</script>
</head>

<body>
<button onclick="saveCourse();">add course</button>
<button onclick="getCourse();">get course</button>
<button onclick="getFakeCourse();">get fakeCourse</button>
<button onclick="clearData();">clearData</button>
</body>