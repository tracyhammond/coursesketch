<html>
<head>
<link rel="stylesheet" href="/css/utility/columns.css">
<link rel="stylesheet" href="/css/courseSketch2.css">
<link rel="stylesheet" href="/css/common/homePage.css">
<link rel="import" href="/src/utilities/libraries/jquery/jqueryInclude.html">
<link rel="import" href="toolbarInclude.html">
<!-- basic utilities -->


</head>
<body>

<toolbar-creation></toolbar-creation>
<input id="background-color" type="color">Choose color</input>

<p>cat cat cat cat cat cat cat dog cat cat cat</p>


<script>    
$(document).bind("mouseup",function(event) {
    
    var myText = window.getSelection();
    var range = myText.getRangeAt(0);
    
    var selStart = range.startOffset;
    var selEnd = range.endOffset;
    var oldText = $(range.commonAncestorContainer).text();
        
    console.log(myText.toString());
    /*if ($(event.target).attr('class') == 'highlightedText') {
        var oldParent = $(event.target.parentNode);
    } else {
        var oldParent = $(event.target);
    }*/
    
    //var oldText = $(oldParent).text();
    /*var oldHtml = $(oldParent).html().toString();
    console.log(oldHtml);
    console.log($(oldHtml).find('span.highlightedText'));
    $(oldHtml).find('span.highlightedText').remove();*/
    
    //if ($(event.target/*.parentNode*/)./*has('.highlightedText').length)*/attr('class') == 'highlightedText') {
        //selEnd = myText.baseOffset + myText.focusOffset;
        //oldText = myText.parentNode;
        //console.log("highlightedtext");
        //console.log(oldText);
        //console.log(event.target.parentNode)
    //} else {
       // selEnd = myText.focusOffset;
        //oldText = $(event.target).text();
        //console.log(oldText);
    //}
    

    
    /*console.log(myText.toString());
    console.log(oldText);
    console.log(range.startOffset);
    console.log(range.endOffset);
    console.log(range.startContainer);
    console.log(range.endContainer);
    console.log(range.commonAncestorContainer.nodeName);
    console.log($(range.commonAncestorContainer).has('.highlightedText').length);
    console.log(myText.toString().length);
    console.log(range.commonAncestorContainer.childNodes);*/
    
    console.log(myText);
    console.log(range);
    
    if (range.commonAncestorContainer.childNodes.length > 0) {
        console.log(range.commonAncestorContainer.childNodes[0].nodeName == '#text');
    }
    
    if (myText.toString().length > 0) {
        clone = range.cloneContents().childNodes;
        if (clone.length > 1) {
            for (i = 0, i < clone.length, i++) {
                if children[i].nodeName
    //for (i = 0; i < range.childNodes
    var newNode = document.createElement('span');
    newNode.setAttribute('class', 'highlightedText');
    newNode.setAttribute('style', 'color:blue');
    //range.selectNode(range.commonAncestorContainer);
    //range.surroundContents(newNode);
    //$(range.toString()).find('span.highlightedText').remove();
    console.log(range.cloneContents().childNodes.length);
    contents = range.extractContents();
    //$(contents).find('span.highlightedText').remove();
    newNode.appendChild(contents);
    range.insertNode(newNode);
    
    //var newText = oldText.substring(0, selStart) + "<span class='highlightedText' style='color:blue'>" + myText.toString() + "</span>" + oldText.substring(selEnd);

    //$(event.target).html($(event.target).html().replace(oldText, newText));
    
});
    
</script>

<body style="background: #55C3C2;">
	<!-- color options: #55C3C2 #A9D0F5 -->
	<!-- Menu Bar -->
	<!-- Center Section -->
	<div class="wide_centre" style="display:flex;">
		<div style="width: 75%;">
			<div class="columnContainer">
				<div>
					<h2 class="homePageHeader" style="text-align: center">Courses</h2>
					<div id="column1"
						class="semi_wide_centre faded_column gradient_faded_column_instructor fullScreenColumn"
						style="overflow-y: scroll; overflow-x: hidden; padding-top: 5px;">
						<button class="myButton2 centre" onclick="addNewCourse()">Add
							New Course</button>
						<div id="class_list_column" class="school_div"></div>
					</div>
				</div>
				<div>
					<h2 class="homePageHeader" style="text-align: center">Assignments</h2>
					<div id="column2"
						class="semi_wide_centre faded_column gradient_faded_column_instructor fullScreenColumn"
						style="overflow-y: scroll; overflow-x: hidden; padding-top: 5px;">
						<div id="assignment_button" style="display: none;">
							<button class="myButton2 centre">Add New Assignment</button>
						</div>
						<div id="assignment_list_column" class="school_div">Click on
							a course</div>
					</div>
				</div>
				<div>
					<h2 class="homePageHeader" style="text-align: center">Problems</h2>
					<div id="column3"
						class="semi_wide_centre faded_column gradient_faded_column_instructor fullScreenColumn"
						style="overflow-y: scroll; overflow-x: hidden; padding-top: 5px;">
						<div id="problem_button" style="display: none;">
							<button class="myButton2 centre">Add New Problem</button>
						</div>
						<div id="problem_list_column" class="school_div">Click on a
							problem</div>
					</div>
				</div>
			</div>
		</div>
		<div style="width: 25%;">
			<h2 class="homePageHeader" style="text-align: center; visibility: hidden;">Hidden Title</h2>
			<div id="column4" class = "fullScreenColumn"
				style="padding-right: 10px; padding-left: 10px; padding-top:5px; background: #55C3C2; overflow:hidden;">
				<div style="background: #FFFFFF; margin-top:-17;">
					<div id="editable_unit" style="height: calc(100% + 5px);">
						<h2 style="text-align: center">Nothing is selected yet</h2>
						<h2 style="text-align: center">Click an item to edit</h2>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>


</html>